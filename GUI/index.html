<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>Genesis 1.0</title>

<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="css/google-fonts.css" rel="stylesheet">
<link href="css/sb-admin-2.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="ui_libs/toastr.min.css">

<link href="css/style.css" rel="stylesheet">
<link href="vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">
<style type="text/css">



#download .refresh {
    width: 30px; height: 30px;
    margin-top: -7px;
    -animation: spin .9s infinite linear;
    -webkit-animation: spin2 .9s infinite linear;
  }
  @-webkit-keyframes spin2 {
    from { -webkit-transform: rotate(0deg);}
    to { -webkit-transform: rotate(360deg);}
  }
  @keyframes spin {
    from { transform: rotate(0deg);}
    to { transform: rotate(360deg);}
  }
  #download {
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
    -o-user-select: none;
    user-select: none;    
  }
</style>




<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- <link rel="stylesheet" type="text/css" href="ui_libs/bootstrap.css"> -->
<script src="ui_libs/popper.min.js"></script>
<script src="ui_libs/toastr.min.js"></script>

<script src="ui_libs/loadingoverlay.min.js"></script>
<script src="ui_libs/aris.js"></script>
<script src="vendor/datatables/jquery.dataTables.min.js"></script>
<script src="vendor/datatables/dataTables.bootstrap4.min.js"></script>

<script language="javascript">

var refreshB64 = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiIHhtbG5zOmlua3NjYXBlPSJodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy9uYW1lc3BhY2VzL2lua3NjYXBlIiB2aWV3Qm94PSIwIC0yNTYgMTc5MiAxNzkyIiBpZD0ic3ZnMiIgdmVyc2lvbj0iMS4xIiBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ4LjMuMSByOTg4NiIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgc29kaXBvZGk6ZG9jbmFtZT0icmVmcmVzaF9mb250X2F3ZXNvbWUuc3ZnIj4gIDxtZXRhZGF0YSBpZD0ibWV0YWRhdGExMiI+ICAgIDxyZGY6UkRGPiAgICAgIDxjYzpXb3JrIHJkZjphYm91dD0iIj4gICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PiAgICAgICAgPGRjOnR5cGUgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIvPiAgICAgIDwvY2M6V29yaz4gICAgPC9yZGY6UkRGPiAgPC9tZXRhZGF0YT4gIDxkZWZzIGlkPSJkZWZzMTAiLz4gIDxzb2RpcG9kaTpuYW1lZHZpZXcgcGFnZWNvbG9yPSIjZmZmZmZmIiBib3JkZXJjb2xvcj0iIzY2NjY2NiIgYm9yZGVyb3BhY2l0eT0iMSIgb2JqZWN0dG9sZXJhbmNlPSIxMCIgZ3JpZHRvbGVyYW5jZT0iMTAiIGd1aWRldG9sZXJhbmNlPSIxMCIgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAiIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiIGlua3NjYXBlOndpbmRvdy13aWR0aD0iNjQwIiBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI0ODAiIGlkPSJuYW1lZHZpZXc4IiBzaG93Z3JpZD0iZmFsc2UiIGlua3NjYXBlOnpvb209IjAuMTMxNjk2NDMiIGlua3NjYXBlOmN4PSI4OTYiIGlua3NjYXBlOmN5PSI4OTYiIGlua3NjYXBlOndpbmRvdy14PSIwIiBpbmtzY2FwZTp3aW5kb3cteT0iMjUiIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjAiIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9InN2ZzIiLz4gIDxnIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLC0xLDEyMS40OTE1MywxMjcwLjIzNzMpIiBpZD0iZzQiPiAgICA8cGF0aCBkPSJtIDE1MTEsNDgwIHEgMCwtNSAtMSwtNyBRIDE0NDYsMjA1IDEyNDIsMzguNSAxMDM4LC0xMjggNzY0LC0xMjggNjE4LC0xMjggNDgxLjUsLTczIDM0NSwtMTggMjM4LDg0IEwgMTA5LC00NSBRIDkwLC02NCA2NCwtNjQgMzgsLTY0IDE5LC00NSAwLC0yNiAwLDAgdiA0NDggcSAwLDI2IDE5LDQ1IDE5LDE5IDQ1LDE5IGggNDQ4IHEgMjYsMCA0NSwtMTkgMTksLTE5IDE5LC00NSAwLC0yNiAtMTksLTQ1IEwgNDIwLDI2NiBxIDcxLC02NiAxNjEsLTEwMiA5MCwtMzYgMTg3LC0zNiAxMzQsMCAyNTAsNjUgMTE2LDY1IDE4NiwxNzkgMTEsMTcgNTMsMTE3IDgsMjMgMzAsMjMgaCAxOTIgcSAxMywwIDIyLjUsLTkuNSA5LjUsLTkuNSA5LjUsLTIyLjUgeiBtIDI1LDgwMCBWIDgzMiBxIDAsLTI2IC0xOSwtNDUgLTE5LC0xOSAtNDUsLTE5IGggLTQ0OCBxIC0yNiwwIC00NSwxOSAtMTksMTkgLTE5LDQ1IDAsMjYgMTksNDUgbCAxMzgsMTM4IFEgOTY5LDExNTIgNzY4LDExNTIgNjM0LDExNTIgNTE4LDEwODcgNDAyLDEwMjIgMzMyLDkwOCAzMjEsODkxIDI3OSw3OTEgMjcxLDc2OCAyNDksNzY4IEggNTAgUSAzNyw3NjggMjcuNSw3NzcuNSAxOCw3ODcgMTgsODAwIHYgNyBxIDY1LDI2OCAyNzAsNDM0LjUgMjA1LDE2Ni41IDQ4MCwxNjYuNSAxNDYsMCAyODQsLTU1LjUgMTM4LC01NS41IDI0NSwtMTU2LjUgbCAxMzAsMTI5IHEgMTksMTkgNDUsMTkgMjYsMCA0NSwtMTkgMTksLTE5IDE5LC00NSB6IiBpZD0icGF0aDYiIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiIHN0eWxlPSJmaWxsOmN1cnJlbnRDb2xvciIvPiAgPC9nPjwvc3ZnPg==';


window.needsUpdate = {
	volRamDumpInput: false, volExecuteDump: false,
	triageCaseFolderInput: false, triageExecuteAnalysis: false };


window.inputFilePaths = {ramImage: '', triageFolderPath: ''};


volFields = {caseName: '', ramFilePath:''}

triageFields = {caseFolderPath: ''};



modesResultsData = {vol: '', triage: '' };




toastr.options = {
	  "closeButton": true,
	  "debug": false,
	  "newestOnTop": false,
	  "progressBar": false,
	  "positionClass": "toast-top-right",
	  "preventDuplicates": false,
	  "onclick": null,
	  "showDuration": "200",
	  "hideDuration": "1000",
	  "timeOut": "3000",
	  "extendedTimeOut": "1000",
	  "showEasing": "swing",
	  "hideEasing": "linear",
	  "showMethod": "fadeIn",
	  "hideMethod": "fadeOut"
	};


showSuccess = function(s) {
  toastr.success(s);
}


showLoader = function(t) {
  // $('#refresh').addClass('disabled');
  $.LoadingOverlay('show', {
    image: '',
    custom: $(HTML(['div', {id: 'download', class: 'row noselect'},
      ['img', {class: 'refresh'}, {src: refreshB64}], 
      ['span', {class: 'ml-2 text'}, t]
    ]))
  });
}

hideLoader = function(error) {
  if (error) toastr.error(error);
  $('#refresh').removeClass('disabled');
  $.LoadingOverlay('hide');
}


$(function () {

	function genCardHeaderCtx(title, fontClass, faClass) { 
		return ['div', {class: 'card-header py-3'},
			['a', {class: fontClass}, title],
			['i', {class: faClass}]

		];

	}

	function genSideDividerCtx() {
		return ['hr', {class: 'sidebar-divider'}];
	}

	function genSideSubHeaderCtx(label) {
		return ['div', {class: 'sidebar-heading'}, label];
	}

	function genSideItemCtx(eleId, label, iconclass) {
		return ['li', {class: 'nav-item unselectable', id: eleId},
			['a', {class: 'nav-link'},
				['i', {class: 'fa-fw ' + iconclass}],
				['span', label]
			]
		];
	}

	function genParaCtx(text, styleClass) {
		return ['p', {class: styleClass}, text];
	}

	function genPageIntroCardCtx(title, titleImgClass, paragraphs, rowClass) {
		return ['div', {class: 'col-xl-12 col-md-12 mb-4'}, 
			['div', {class: ' carddiscored shadow mb-4'}, 
				['div', {class: 'card-header py-3'},
					['a', {class: 'm-0 font-weight-bold text-primary'},title],
					['i', {class: 'ml-2 fa-1x ' + titleImgClass + " "}]
				],
				['div', {class: 'card-body ' + rowClass},
						paragraphs
				]
			]
		];

	}

	function genImageDescCardCtx(title, paragraphs) {
		return ['div', {class: 'col-xl-12 col-md-12 mb-4'}, 
			['div', {class: 'border-bottom-secondary carddiscored shadow mb-4'}, 
				['div', {class: 'card-header py-3'},
					['h6', {class: 'm-0 font-weight-bold text-primary'},title]                
				], paragraphs
			]
		];

	}


	function genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, bodyElements) {
		return ['div', {class: 'unselectable mb-4 ' + gridClass},
			['div', {id: cardId, class: 'card shadow h-100  ' + colorStyle + " " + hoverStyle}, 
			// ['div', {id: cardId, class: 'card shadow h-100 py-2' + " border-bottom-" + colorStyle + " " + hoverStyle}, 

				['div', {class: 'card-body'},
					bodyElements
				]
			]
		];
	}

	function genInfoBodyCtx(title, desc, iconClass, colorStyle) {
		return ['div', {class: 'row no-gutterse align-items-center'},
			['div', {class: 'col mr-2'},
				['div', {class: "text-xl font-weight-bold text-uppercase mb-5 text-" + colorStyle}, title],
				['div', {class: "h5 mb-0 font-weight-bold text-gray-800"}, desc]
			],
			['div', {class: 'col-auto'},
				['i', {class: 'text-gray-700  ' + iconClass}]
			]
		];
	}

	function genSmallBodyCtx(title, descId, desc, iconClass, colorStyle) {
		return ['div', {class: 'row no-gutterse align-items-center justify-content-center mb-0 d-flex'},
			['div', {class: 'col mr-2'},
				['div', {class: "text-xl font-weight-bold text-uppercase mb-5 text-" + colorStyle}, title],
				['div', {id: descId, class: "h5 mb-0 font-weight-bold text-gray-800"}, desc]
			],
			['div', {class: 'col-auto'},
				['i', {class: 'text-gray-700 ' + iconClass}]
			]
		];
	}

	function genSmallBodyNoImgCtx(title, descId, desc, colorStyle) {
		return ['div', {class: 'row no-gutterse align-items-center justify-content-center mb-0 d-flex'},
			['div', {class: 'col'},
				['div', {class: "text-xl font-weight-bold text-uppercase mb-5 text-" + colorStyle}, title],
				['div', {id: descId, class: "h5 mb-0 font-weight-bold text-gray-800"}, desc]
			]			
		];
	}

	function genTableBodyCtx(title, desc, iconClass, colorStyle, tableHeader, tableRows) {
		return ['div', {class: 'row no-gutterse align-items-center justify-content-center mb-0 d-flex'},
			['div', {class: 'col mr-2'},
				['div', {class: "text-xl font-weight-bold text-uppercase mb-5 text-" + colorStyle}, title],
				['div', {class: "h5 mb-0 font-weight-bold text-gray-800"}, desc]
			],
			['div', {class: 'col-auto'},
				['i', {class: 'text-gray-700 ' + iconClass}]
			],

		];
	}

	

	function genHomeCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, desc, iconClass) {
		return genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, genInfoBodyCtx(title, desc, iconClass, colorStyle));
	}

	function genTriageCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, descId, desc, iconClass) {
		return genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, genSmallBodyCtx(title, descId, desc, iconClass, colorStyle));
	}

	function genMalwareCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, descId, desc, iconClass) {
		return genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, genSmallBodyCtx(title, descId, desc, iconClass, colorStyle));
	}


	function genNoImageCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, descId, desc) {
		return genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, genSmallBodyNoImgCtx(title, descId, desc, colorStyle));	
	}
	function genTableCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, desc, iconClass) {

	}
	// Context for inputs
	function genButtonCtx(btnId, label, iconClass, colorStyle) {
		return ['a', {id: btnId, class: 'btn btn-icon-split mt-4 ' + "btn-" + colorStyle},
			['span', {class: 'icon text-white-50'},
				['i', {class : iconClass}]
			],
			['span', {class: 'text btn-white'}, label]
		];
	}

	function genInputSelectorCtx(inputId, placeHolder, type) {
		var input = null;
		if (type === "FILE") {
			input = ['input',  {id: inputId, class: 'custom-file-input', required: "required"},
				['label', {id : inputId + "-label", class: 'custom-file-label', for: 'validatedCustomFile'}, placeHolder],
				['div', {class: 'invalid-feedback'}, "Invalid file"]
			];
		} else if (type === "FOLDER") {
			input = ['input',  {id: inputId, class: 'custom-file-input'},
				['label', {id : inputId + "-label", class: 'custom-file-label', for: 'validatedCustomFile'}, placeHolder],
				['div', {class: 'invalid-feedback'}, "Invalid folder"]
			];
		}
		return ['div', {class: 'custom-file'}, input];

	}

	function genTextInputCtx(inputId, placeHolder) {
		return ['input', {class: 'form-control', id: inputId, placeholder: placeHolder}];
	}
	
	function genRequiredTextCtx(cardId, cardTitle, inputId, inputPlaceHolder, colorStyle) {
		return ['div', {class: 'col-xl-12 col-md-12 mb-4'},
			['div', {class: 'card  shadow h-100 py-3 border-left-' + colorStyle + ' '},
				['div', {class: 'card-body'},
					['div', {class: 'row no-gutters align-items-center'},
						['div', {class: 'col mr-2'},
							['div',{class: 'text-xs font-weight-bold text-info text-uppercase mb-1'}, cardTitle],
							genTextInputCtx(inputId, inputPlaceHolder),
							
						]                   
						
					]
				]        
			]
		];
	}

	function genFileSelectCtx(cardId, cardTitle, inputId, inputPlaceHolder, inputType, btnId, btnLabel, btnIconClass, colorStyle) {
		return ['div', {class: 'col-xl-12 col-md-12 mb-4'},
			['div', {class: 'card  shadow h-100 py-3 border-left-' + colorStyle + ' '},
				['div', {class: 'card-body'},
					['div', {class: 'row no-gutters align-items-center'},
						['div', {class: 'col mr-2'},
							['div',{class: 'text-xs font-weight-bold text-info text-uppercase mb-1'}, cardTitle],
							genInputSelectorCtx(inputId, inputPlaceHolder, inputType), 
							genButtonCtx(btnId, btnLabel, btnIconClass, colorStyle)
						]                   
						
					]
				]        
			]
		];
	}



	function genTriageCheckBoxCtx(chkId, title, iconClass) {
		return ['div', {class: 'no-gutterse align-items-center justify-content-center'}, 
			['div', {class: 'justify-content-center'}, 
				['div', {class: 'row card-header'},
					['div', {class: ''},
						['p', {class: 'm-0 font-weight-bold text-primary'},title],
						['a', {class: 'fa-2x fas fa-wifi'}]                     
					],
					['div', {class: 'ml-auto my-auto mr-5'},

						['input', {class: 'ml-auto big-checkbox form-check-input', id: "defaultCheck1", type: 'checkbox', value: ''}],

					]                   
				]
				
			]
		];  
	}



	function genTableHeadersCtx(headersData) {
		var temp = ['tr'];
		for (let i = 0; i < headersData.length; i++) {
			temp.push(['th', headersData[i]]);
		}
		temp = ['thead'].push(temp);
		// console.log(temp)
		return temp

	}

	function genTableRowDataCtx(rowsData) {
		var temp = ['tr'];
		// Iterate the thing to see if got multiple Data Rows
		for (let i = 0; i < rowsData.length; i++) {
			for (let j =0; j < rowsData[i].length; j++) {
				temp.push(['td', rowsData[i][j]]);      
			}
			
		}
		temp = ['tbody'].push(temp);
		// console.log(temp);
		return temp
	}

	function genTableWithDivCtx(mainDivId, subDivId, tblId, divDesc, headersData, rowsData) {
		
		return ['div', {id: mainDivId, class: 'col-xl-12 col-md-12 mb-4'},
			['div', {class: 'card shadow mb-4'},
				['div', {class: 'card-header py-3'},
					['h6',  {class: 'm-0 font-weight-bold text-primary'}, divDesc]
				],
				['div', {id: subDivId, class: 'card-body'},
					['div', {class: 'table-responsive'},
						['table', {id: tblId, class: 'table table-bordered results-table',  width: '100%', cellspacing: '0'},
							['thead', 
								['tr', headersData, function(x) { return ['th', x] } ]
							],
							['tbody', rowsData, function(a) {
								return ['tr', a, function(b) {
										return ['td', b]
									}]									
								}
							]
					   ]
					]
				]
			]
		];  
		
	}





	// genTableWithDivCtx('evt-results-cont', 'evt-results-sub-cont', 'evt-results-tbl', 'Log Analysis Results')])

	function genCardBodyImgCtx(imgPath) {
		return ['div', {class: 'text-center'},
			['img', {class: 'img-fluid px-3 px-sm-4 mt-3 mb-4 tech-info-img', src: imgPath}]
		];
	}

	

	function genCardInfoCtx(title, imgSrc, bodyEles, cardClass, cardHeaderClass, titleClass) {
		return ['div', {class: cardClass},
			['div', {class: cardHeaderClass},
				['h6', {class: titleClass}, title]
			],
			['div', {class: 'card-body'},
				bodyEles                        
			]
		];
	}

	function genCardBodyCtx(bodyImgPath, paraElements) {
		return [genTechCardBodyImgCtx(bodyImgPath),
			paraElements
		];

	}

	function genTechCardBodyImgCtx(imgPath) {
		return genCardBodyImgCtx(imgPath);
	}



	function genTechCardInfoCtx(title, imgSrc, bodyEles) {
		return genCardInfoCtx(title, imgSrc, bodyEles, 'card shadow mb-4', 'card-header py-3', 'm-0 font-weight-bold text-primary');
	}

	function genTechCardBodyParaCtx(linkLabel, hyperLinkUrl, paraText) {
		return ['p',
			['a', {rel: 'nofollow', href: hyperLinkUrl}, linkLabel], paraText 
		];

	}


	function genAboutCardInfoCtx(title, imgSrc, bodyEles) {
		return genCardInfoCtx(title, imgSrc, bodyEles, 'card shadow mb-4', 'card-header py-3', 'm-0 font-weight-bold text-primary');
	}

	function genAboutCardBodyParaCtx(paraClass, paraText) {
		return ['p', {class: paraClass}, paraText ];

	}
	
	
	var cardTechBodyPythonEleCtx = [
		genTechCardBodyImgCtx('img/python.png'),
		['p',
			['a', {rel: 'nofollow', href: 'https://www.python.org/'},'Python'],
			' is an interpreted, object-oriented, high-level programming language with dynamic semantics. Its high-level built in data structures, combined with dynamic typing and dynamic binding, make it very attractive for Rapid Application Development, as well as for use as a scripting or glue language to connect existing components together.'
		]
	];


	// First Tech Card
	var techInfoPythonCtx = genTechCardInfoCtx(
		'Python', 
		'img/python.png', 
		genCardBodyCtx('img/python.png', 
			genTechCardBodyParaCtx('Python', 
				'https://www.python.org/', 
				' is an interpreted, object-oriented, high-level programming language with dynamic semantics. Its high-level built in data structures, combined with dynamic typing and dynamic binding, make it very attractive for Rapid Application Development, as well as for use as a scripting or glue language to connect existing components together.'
			)
		)
	);

	var techInfoVolatilityCtx = genTechCardInfoCtx(
		'Volatility', 
		'img/volatility.png', 
		genCardBodyCtx('img/volatility.png', 
			genTechCardBodyParaCtx('Volatility', 
				'https://www.volatilityfoundation.org/', 
				' Framework is a completely open collection of tools, implemented in Python under the GNU General Public License, for the extraction of digital artifacts from volatile memory (RAM) samples.'
			)
		)
	);

	

	var techInfoSeleniumCtx = genTechCardInfoCtx(
		'Selenium', 
		'img/selenium.png', 
		genCardBodyCtx('img/selenium.png', 
			genTechCardBodyParaCtx('Selenium', 
				'https://selenium-python.readthedocs.io/',
				' bindings provides a simple API to write functional/acceptance tests using Selenium WebDriver. Through Selenium Python API you can access all functionalities of Selenium WebDriver in an intuitive way.'
			)
		)
	); 
	var techInfoJqueryCtx = genTechCardInfoCtx(
		'Jquery', 
		'img/jquery.png', 
		genCardBodyCtx('img/jquery.png', 
			genTechCardBodyParaCtx('Jquery', 
				'https://jquery.com/',
				' is a fast, small, and feature-rich JavaScript library. It makes things like HTML document traversal and manipulation, event handling, animation, and Ajax much simpler with an easy-to-use API that works across a multitude of browsers.'
			)
		)
	); 

	var techInfoBootstrapCtx = genTechCardInfoCtx(
		'Bootstrap', 
		'img/bootstrap.png', 
		genCardBodyCtx('img/bootstrap.png', 
			genTechCardBodyParaCtx('Bootstrap', 
				'https://getbootstrap.com/',
				' is a free and open-source CSS framework directed at responsive, mobile-first front-end web development. It contains CSS- and (optionally) JavaScript-based design templates for typography, forms, buttons, navigation, and other interface components.'
			)
		)
	); 
	var techInfoPowershellCtx = genTechCardInfoCtx(
		'Powershell', 
		'img/powershell.png', 
		genCardBodyCtx('img/powershell.png', 
			genTechCardBodyParaCtx('Powershell', 
				'https://docs.microsoft.com/en-us/powershell/',
				' is a cross-platform task automation and configuration management framework, consisting of a command-line shell and scripting language. Unlike most shells, which accept and return text, PowerShell is built on top of the .NET Common Language Runtime (CLR), and accepts and returns .NET objects. This fundamental change brings entirely new tools and methods for automation.'
			)
		)
	); 

	var techInfoBashBunnyCtx = genTechCardInfoCtx(
		'Bashbunny', 
		'img/bash_bunny.png', 
		genCardBodyCtx('img/bash_bunny.png', 
			genTechCardBodyParaCtx('Bashbunny', 
				'https://shop.hak5.org/products/bash-bunny',
				' by Hak5 is the world’s most advanced USB attack platform. It delivers penetration testing attacks and IT automation tasks in seconds by emulating combinations of trusted USB devices – like gigabit Ethernet, serial, flash storage and keyboards. With it, computers are tricked into divulging data, exfiltrating documents, installing backdoors and many more exploits.'
			)
		)
	);

	var techInfoTensorFlowCtx = genTechCardInfoCtx(
		'Tensorflow', 
		'img/tensor_flow.png', 
		genCardBodyCtx('img/tensor_flow.png', 
			genTechCardBodyParaCtx('Tensorflow', 
				'https://www.tensorflow.org/',
				' is a free and open-source software library for machine learning. It can be used across a range of tasks but has a particular focus on training and inference of deep neural networks.'
			)
		)
	);

	
	// Display Side Bar
	var sideHomeCtx = genSideItemCtx("side-home", "Home", "fas fa-tachometer-alt active");
	var sideVolatilityCtx = genSideItemCtx("side-volatility", "Volatility Dump", "fas fa-memory");
	var sideTriageCtx = genSideItemCtx("side-triage", "Triage Analysis", "fab fa-searchengin");
	var sideMalwareCtx = genSideItemCtx("side-malware", "Malware Heuristics", "fas fa-biohazard");
	var sideEventCtx = genSideItemCtx("side-event", "Event Logs Correlator", "fas fa-chart-area");
	var sideTechnologiesCtx = genSideItemCtx("side-technologies", "Technologies Used", "fas fa-question-circle");
	var sideAboutCtx = genSideItemCtx("side-about", "About", "fas fa-user-secret");
	var sideReviewCtx = genSideItemCtx("side-review", "Review Results", "fas fa-scroll");

	var sideMenuCtx = [
		sideHomeCtx,
		genSideDividerCtx(),
		genSideSubHeaderCtx("Triage"),
		sideVolatilityCtx,
		sideTriageCtx,
		genSideDividerCtx(),
		genSideSubHeaderCtx("Analysis"),
		sideMalwareCtx,
		sideEventCtx,
		sideReviewCtx,
		genSideDividerCtx(),
		genSideSubHeaderCtx("Misc"),
		sideTechnologiesCtx,
		sideAboutCtx
	];

// End of Display Side menu

"row-home"
"row-volatility"
"row-triage"
"row-malware"
"row-event"
"row-about"
"row-technologies"
"row-review"



// gridClass, colorStyle, title, desc, iconClass

	var homevolatilityDumpCtx = genHomeCardCtx("home-volatility-card", "col-xl-6 col-md-6 col-sm-12 col-12", "border-bottom-primary", "home-card", "Volatility", "Extract of host PC's RAM for Triage Analysis", "fa-6x fas fa-memory");

	var homeTriageCtx = genHomeCardCtx("home-triage-card", "col-xl-6 col-md-6 col-sm-12 col-12", "border-bottom-success", "home-card", "Triage Analyis", "Conducts full analysis of Volatility with analysis modules", "fa-6x fab fa-searchengin");

	var homeMalwareCtx = genHomeCardCtx("home-malware-card", "col-xl-6 col-md-6 col-sm-12 col-12", "border-bottom-danger", "home-card", "Malware Heuristics", "Classify & identify IOCs of PE file using heuristics", "fa-6x fas fa-biohazard");

	var homeEventLogCtx = genHomeCardCtx("home-event-card", "col-xl-6 col-md-6 col-sm-12 col-12", "border-bottom-danger", "home-card", "Event Logs Correlator", "Identify potential footprints of malwares with event logs", "fa-6x fas fa-chart-area");

	var homeReview = genHomeCardCtx("home-review-card", "col-xl-12 col-md-12 col-sm-12 col-12 pb-3", "border-bottom-info", "home-card", "Triage Review", "Review past Triage analysis results", "fa-6x fas fa-scroll");


	var dashboardCtxs = [homevolatilityDumpCtx,homeTriageCtx,homeMalwareCtx,homeEventLogCtx, homeReview];


	var volatilityRequiredRamDumpCtx = ['div', {class: 'col-xl-12 col-md-12 mb-4'},
		['div', {class: 'card border-left-success shadow h-100 py-3'},
			['div', {class: 'card-body'},
				['div', {class: 'row no-gutters align-items-center'},
					['div', {class: 'col mr-2'},
						['div',{class: 'text-xs font-weight-bold text-info text-uppercase mb-1'}, "Choose your RAM dump file"],
						genInputSelectorCtx("volatility-ram-dump-input", "Choose file...", "FILE"), 
						genButtonCtx("volatility-btn-dump", "Execute dump", "fas fa-play", "info")
						// ['div',{class: 'text-xl font-weight-bold text-success text-uppercase mb-1'}, "Available RAM Size"],
						// ['div', {class: 'h2 mb-0 font-weight-bold text-gray-800'}, "32 GB"]
					]
					// ['div', {class: 'col-auto'}, 
					// 	['i' , {class: 'fas fa-memory fa-6x text-gray-300'}]
					// ]
					
				]
			]        
		]
	];



	var volatiltiyInstructionsCtx = genPageIntroCardCtx("Instructions", "fas fa-info-circle", [
		genParaCtx("Fill in case name & choose folder location to dump analysis output", "", "")
	]);


	var volatilityRequiredCaseNameCtx = genRequiredTextCtx('volatility-card-input-fields',
		'Please fill in the required fields',
		'volatility-card-input-case-name', //Try impv to put list and handle it
		'Case name',
		'info');


	var volatilityRequiredInputCtx = genFileSelectCtx("volatility-card-select-file",
		"Choose your dump RAM file",
		"volatility-input-file",
		"Choose file...",
		"FILE",
		"volatility-btn-dump",
		"Execute Dump",
		"fas fa-play",
		"info"
	);

	var triageInstructionsCtx = genPageIntroCardCtx("Instructions", "fas fa-info-circle", [
		genParaCtx("Fill in case name & choose folder location to dump analysis output", "", "")
	]);



	var triageFunctionsDescCtx = genPageIntroCardCtx("Functionalities", "fas fa-atom", [
		genParaCtx("The whole triage process covers the following ", "h4 col-12 mb-5" ),
		genTriageCardCtx("triage-func-process", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "border-bottom-success", "", "Processes", "triage-func-process-label", "", "fa-2x fas fa-microchip"),
		genTriageCardCtx("triage-func-files", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "border-bottom-success", "", "Files", "triage-func-files-label", "", "fa-2x fas fa-file-alt"),

		genTriageCardCtx("triage-func-domains", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "border-bottom-success", "", "Domains", "triage-func-domains-label", "", "fa-2x fas fa-server"),
		genTriageCardCtx("triage-func-malware", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "border-bottom-success", "", "Malware", "triage-func-malware-label", "", "fa-2x fas fa-biohazard icon-cog"),
		genTriageCardCtx("triage-func-logs-analysis", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "border-bottom-success", "", "Logs-Analysis", "triage-func-logs-analysis-label", "", "fa-2x fas fa-chart-area"),
		
		
		genTriageCardCtx("triage-func-virustotal", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "border-bottom-success", "", "Virustotal", "triage-func-virustotal-label", "", "fa-2x fas fa-viruses")],
		"row"
	);


	var triageRequiredFieldsCtx = genRequiredTextCtx('trigage-card-input-fields',
		'Please fill in the required fields',
		'triage-card-input-case-name', //Try impv to put list and handle it
		'Case name', 
		'info');

	var triageRequiredInputCtx = genFileSelectCtx("triage-card-select_dump_folder",
		"Choose your volatility dump folder",
		"triage-dump-folder",
		"Choose folder...",
		"FILE",
		"triage-dump-run",
		"Execute analysis",
		"fas fa-play",
		"info"
	);
	var triageResultsMetaNameCtx = 
			genNoImageCardCtx("triage-result-meta-name", // card ID
					"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", //gridClass
					"py-0", //colorStyle
					"border-bottom-info", //hoverStyle
					"Name", //title
					"triage-result-meta-name-label", //descId
					"ICTNYP-NB17");

	// genNoImageCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, descId, desc) {
	var triageResultsMetaImageDateCtx = 
		genNoImageCardCtx("triage-result-meta-datetime", // card ID
			"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", //gridClass
			"py-0", //colorStyle
			"border-bottom-info", //hoverStyle
			"Image DateTime", //title
			"triage-result-meta-datetime-label", //descId
			"2020-10-27 12:49:25 UTC+0000");

	var triageResultsMetaModelCtx = 
		genNoImageCardCtx("triage-result-meta-model", // card ID
				"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", //gridClass
				"py-0", //colorStyle
				"border-bottom-info", //hoverStyle
				"Model", //title
				"triage-result-meta-model-label", //descId
				"Latitude 5590");

	var triageResultsMetaManufacturerCtx = 
			genNoImageCardCtx("triage-result-meta-manufacturer", // card ID
					"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", //gridClass
					"py-0", //colorStyle
					"border-bottom-info", //hoverStyle
					"Manufacturer", //title
					"triage-result-meta-manufacturer-label", //descId
					"Dell Inc.");



	// Name ImgDateTime Model Manufacturer 




	var triageResultProcessCountCtx = 
		genTriageCardCtx("triage-result-process-info", // card ID
			"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", 
			"border-bottom-primary", 
			"", 
			"Number of Processes", 
			"triage-process-info-label", 
			"101 "+ "Processes running", 
			"fa-3x fas fa-microchip");

	var triageResultDomainResultsCtx = 
		genTriageCardCtx("triage-result-domain-info", // card ID
			"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", 
			"border-bottom-primary", 
			"", 
			"Domains/IPS Found", 
			"triage-domain-info-label", 
			"3 "+ "IP Addresses Found", 
			"fa-3x fas fa-server");

	var triageResultMalignFilesCtx = 
		genTriageCardCtx("triage-result-malign-files-info", // card ID
			"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", 
			"border-bottom-danger", 
			"", 
			"Number of Malign Files", 
			"triage-malign-files-info-label", 
			"3 out of 200 are flagged", 
			"fa-3x fas fa-viruses");

	var triageResultMalignEventsCtx = 
		genTriageCardCtx("triage-result-malign-events-info", // card ID
			"col-xl-6 col-lg-6 col-md-6 triage-results-card mt-3", 
			"border-bottom-danger", 
			"", 
			"Flagged Events", 
			"triage-malign-events-info-label", 
			"2 suspicious events found", 
			"fa-3x fas fa-viruses");


	var triageResultWhoIsResultsCtx = genTableWithDivCtx("triage-pstree-table-div", 
		"triage-pstree-inner-div", 
		"triage-pstree-table", 
		'Process Tree results', 
		["Name", "PID", "PPID", "Threads", "Handles", "Time"],
		[
			["IP", "Organisation", "HostName", "ISP", "Continent", "Country", "State/Region", "City"]
			// ["IP Address", "Org" "Security.evtx", "15", "Your mother v cute"],
			// ["Sunday 2359", "Security.evtx", "15", "Jerome so cute wow hehe"],
		]);



	var triageResultWhoIsResultsCtx = genTableWithDivCtx("triage-whois-table-div", 
		"triage-whois-inner-div", 
		"triage-whois-table", 
		'WhoIsDomain Lookup for IP Addresses', 
		["IP", "Organisation", "HostName", "ISP", "Continent", "Country", "State/Region", "City"],
		[
			["IP", "Organisation", "HostName", "ISP", "Continent", "Country", "State/Region", "City"]
			// ["IP Address", "Org" "Security.evtx", "15", "Your mother v cute"],
			// ["Sunday 2359", "Security.evtx", "15", "Jerome so cute wow hehe"],
		]);



	var triageResultEvtTableCtx = genTableWithDivCtx("triage-evt-table-div", 
		"triage-evt-inner-div", 
		"triage-evt-table", 
		'Event Logs Analysis', 
		['RuleTriggered', 'RuleName', 'EventID', 'Timestamp', 'EventRecordID', 'Description', 'IPAddress'],
		[
			['RuleTriggered', 'RuleName', 'EventID', 'Timestamp', 'EventRecordID', 'Description', 'IPAddress']
		]);

	var triageResultsExesTableCtx = genTableWithDivCtx("triage-exes-table-div", 
		"triage-exes-inner-div", 
		"triage-exes-table", 
		'Executables', 
		["File Name", "MD5", "SHA1", "VirusTotal", "Heuristics Indicators", "Tensorflow Model"],
		[
			["JeromeNoodes", "SHA1", "HashYourDaddy", "30/60", "1/20", "73.5%"],
			["JeromeNoodes1", "SHA1", "HashYourDaddy2", "30/60", "1/20", "73.5%"]
		]);

	var triageResultsDllTableCtx = genTableWithDivCtx("triage-dlls-table-div", 
		"triage-dlls-inner-div", 
		"triage-dlls-table", 
		'Dynamic Linking Libraries (DLLs)', 
		["File Name", "MD5", "SHA1", "VirusTotal", "Heuristics Indicators", "Tensorflow Model"],
		[
			["JeromeNoodes", "SHA1", "HashYourDaddy", "30/60", "1/20", "73.5%"],
			["JeromeNoodes1","SHA1", "hashYourDaddy2", "30/60", "1/20", "73.5%"]
		]);



	var triageResultsPanelCtx = ['div', {id:'res-triage-panel', class: 'col-xl-12 col-md-12 mb-4 results-container'} ,
		['div', {class: 'card'},
			genCardHeaderCtx("Results",
				"m-0 font-weight-bold text-secondary", 
				"ml-2 fa-1x fas fas fa-chart-bar"),
				['div', {class: 'card-body row'},
					triageResultsMetaNameCtx,
					triageResultsMetaImageDateCtx,
					triageResultsMetaModelCtx,
					triageResultsMetaManufacturerCtx,

					triageResultProcessCountCtx,
					triageResultDomainResultsCtx,

					triageResultMalignFilesCtx,
					triageResultMalignEventsCtx,

					triageResultWhoIsResultsCtx,
					
					triageResultsExesTableCtx,
					triageResultsDllTableCtx,
					triageResultEvtTableCtx
				]	

		]

	];


	var malwareFunctionsCtx = genPageIntroCardCtx("Functions", "fas fa-atom", [
		genParaCtx("This module analyses Portable Executables (PE) files in several aspect", "fa-2x h4 col-12 mb-5" ),
		genMalwareCardCtx("malware-func-heuristics", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "border-bottom-primary", "", "Heuristics", "malware-func-heuristics-label", "", "fa-2x fas fa-viruses"),
		genMalwareCardCtx("malware-func-entropy", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "border-bottom-primary", "", "Entropy", "malware-func-entropy-label", "", "fa-2x fas fa-sort-numeric-up-alt"),
		genMalwareCardCtx("malware-func-imports", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "border-bottom-primary", "", "Functions", "malware-func-imports-label", "", "fa-2x fas fa-file-import"),
		genMalwareCardCtx("malware-func-ml", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "border-bottom-primary", "", "ML", "malware-func-ml-label", "", "fa-2x fas fa-robot")],
		"row"
	);

	var malwareRequiredInputCtx = genFileSelectCtx("malware-card-select-file",
		"Choose your PE file to analyse",
		"malware-input-folder",
		"Choose file...",
		"FILE",
		"malware-btn-run",
		"Execute analysis",
		"fas fa-play",
		"info"
	);


	var evtInstructionsCtx = genPageIntroCardCtx("Information", "fas fa-info-circle", [
		genParaCtx("Select desired windows log to analyse. Some examples of windows logs are Security.evtx, System.evtx, etc.", "", "")
	]);

	var evtRequiredInputCtx = genFileSelectCtx("evt-card-select-file",
		"Choose your Windows Log to analyse",
		"evt-input-folder",
		"Choose file...",
		"FILE",
		"evt-btn-run",
		"Execute correlation",
		"fas fa-play",
		"info"
	);


	var malwareResultsHeuristicsCardCtx = genInfoCardCtx('malware-single-heuristics-info', 
		"col-xl-6 col-md-6 col-sm-12 col-12 justify-content-center",
		"col-xl-6 col-md-6 col-sm-12 col-12 justify-content-center",

		"primary",
		"",
		['div', {class: 'row no-gutters align-items-center'},
			['div', {class: 'col mr-2'},
				['div',{class: 'text-xl font-weight-bold text-primary text-uppercase mb-1'}, "Heuristics"],
				['div', {id:'res-malware-single-heuristics-score', class: 'h5 mb-0 font-weight-bold text-gray-800'}, "2 / 31 "]
			],
			['div', {class: 'col-auto'}, 
				['i' , {class: 'fas fa-viruses fa-6x text-gray-300'}]
			]
			
		]);

	var malwareResultHeuristicsScoreCtx = 
		genMalwareCardCtx("malware-single-heuristics-info", // card ID
			"col-xl-12 col-lg-12 col-md-6 malware-results-card mt-3", 
			"border-left-primary", 
			"", 
			"Heuristics Score", 
			"malware-single-heuristics-info-label", 
			"2 / 23", 
			"fa-3x fas fa-viruses");


	var malwareResultEmberPredictionScoreCtx = 
		genMalwareCardCtx("malware-single-ember-score", 
			"col-xl-12 col-lg-12 col-md-6 malware-results-card", 
			"border-left-primary", 
			"", 
			"Ember Prediction", 
			"malware-single-ember-score-label", 
			"0.154 / 1", 
			"fa-3x fas fa-fire"); 

	var malwareResultMLPredictionScoreCtx =
		genMalwareCardCtx("malware-single-ml-score", 
			"col-xl-12 col-lg-12 col-md-6 malware-results-card", 
			"border-left-primary", 
			"", 
			"ML Prediction", 
			"malware-single-ml-score-label", 
			"60 %", 
			"fa-3x fas fa-robot"); 

	var malwareResultEntropyTableCtx = genTableWithDivCtx("malware-single-entropy-table-div", 
		"malware-single-entropy-inner-div", 
		"malware-single-entropy-table", 
		'PE Section Details', 
		["Name", "Entropy", "VirtualAddress", "Misc_VirtualSize", "SizeOfRawData", "Characteristics"],
		[
			["Name1", "Entropy1", "VirtualAddress1", "Misc_VirtualSize1", "SizeOfRawData1", "Characteristics1"],
			["Name2", "Entropy2", "VirtualAddress2", "Misc_VirtualSize2", "SizeOfRawData2", "Characteristics2"]
		]);

	var malwareResultEntropyDetailsCtx = genInfoCardCtx('malware-single-section-details', 
		'col-xl-12 col-lg-12 col-md-6 malware-results-card', 
		'border-bottom-primary', 
		"", //hoverStyle
		''); //Put table here


	// Put into results panel
	var malwareResultsPanelCtx = ['div', {id:'res-malware-single-panel', class: 'col-xl-12 col-md-12 mb-4 results-container'} ,
		['div', {class: 'card '},
			genCardHeaderCtx("Results",
			"m-0 font-weight-bold text-secondary", 
			"ml-2 fa-1x fas fas fa-chart-bar"),

			// ['div', {class: 'card-header py-3'}]
			malwareResultHeuristicsScoreCtx,
			malwareResultEmberPredictionScoreCtx,
			malwareResultMLPredictionScoreCtx,
			malwareResultEntropyTableCtx



		]

	];

	

	var reviewInstructionsCtx = genPageIntroCardCtx("Instructions", "fas fa-info-circle", [
		genParaCtx("Browse to the case folder and click execute", "", "")
	]);


	var reviewRequiredCaseFolderCtx = genFileSelectCtx("review-card-select-folder",
		"Choose your case folder",
		"review-input-folder",
		"Choose folder...",
		"FOLDER",
		"review-btn-dump",
		"Review case",
		"fas fa-play", //Icon Picture
		"info" //Style
	);

	// genInfoBodyCtx(title, desc, iconClass, colorStyle)


	// genHomeCardCtx("home-volatility-card", "col-xl-6 col-md-6 col-sm-12 col-12", "primary", "home-card", "Volatility", "Extract of host PC's RAM for Triage Analysis", "fa-6x fas fa-memory");


	var evtTempTableCtx = genTableWithDivCtx('evt-results-cont', 'evt-results-sub-cont', 'evt-results-tbl', 'Log Analysis Results', ['h1','h2','h3', 'h4'], [['R1','R2','R3', 'R4'], ['r5','r6','r7', 'r8']]);




	var arrTitles = {
			"home": "What do you want to do",
			"volatility": "Volatility Dump",
			"triage": "Automated RAM Analysis",
			"malware": "Malware Heuristics",
			"event": "Windows Logs Correlator",
			"about": "About",
			"technologies": "Technologies Used",
			"review": "Review Triage Results"
	};

	


	var aboutIntroDetails = [
		{"Name":"Kevin", "imagePath":"img/kevin.png"},		
		{"Name":"Patrick", "imagePath":"img/patrick.png"},
		{"Name":"Jerome", "imagePath":"img/jerome.png"},
		{"Name":"Cleaven", "imagePath":"img/cleaven.png"},		
		{"Name":"Longxian", "imagePath":"img/longxian.jpg"}		
	];

		
	var aboutIntroCtx = genAboutCardInfoCtx(
			"Introduction",
			'img/genesis.png',
			genCardBodyCtx('img/genesis.png',[
				genAboutCardBodyParaCtx("","As technologies advance over the years, the rates of targeted cyber-attacks become even more prevalent. When these attacks happen, many companies do not know when or how their infrastructures are being compromised, and thus are unable to provide a direction for forensic investigations."),
				genAboutCardBodyParaCtx("","Our solution aims to provide as much information as possible within the forensic bailiwick of an investigation. It consists of a trilogy of modules - a Windows Event Log analyzer, a PE static analyzer, and an IOC detector. Together with an interactive GUI to ease navigation between modules and display our results, we believe that our solution will be extremely valuable in the forensics community.")]
			)
		);


	var aboutPeopleCtx = [aboutIntroDetails, function (d) {
		return ['div', {class: 'col-lg-6'},
			['div', {class: 'card position-relative'},
				['div', {class: 'card-header py-3'},
					['h6', {class: 'm-0 font-weight-bold text-primary'}, d.Name]
				],
				['div', {class: 'card-body'},
					['img', {class: 'img-fluid px-3 px-sm-4 mt-3 mb-4 about-info-img', src: d.imagePath}],					
					['div',  {class: 'mb-1'}],
					['p', {class: 'mb-0 small'}]
				]
			]
		]
	}];
	

	$('#row-home').html(HTML(dashboardCtxs));
	$(HTML(sideMenuCtx)).insertAfter('#first-boarder');
	// 1
	$('#row-volatility').html(HTML([volatiltiyInstructionsCtx, volatilityRequiredCaseNameCtx, volatilityRequiredRamDumpCtx]));

	// 2
	$('#row-triage').html(HTML([triageInstructionsCtx, triageFunctionsDescCtx, triageRequiredInputCtx, triageResultsPanelCtx]));
	
	// 3
	$('#row-malware').html(HTML([malwareFunctionsCtx, malwareRequiredInputCtx, malwareResultsPanelCtx]));

	$('#row-event').html(HTML([evtInstructionsCtx, evtRequiredInputCtx,evtTempTableCtx]));

	$('#row-review').html(HTML([reviewInstructionsCtx, reviewRequiredCaseFolderCtx]));

	$("#row-technologies").html(HTML([techInfoBashBunnyCtx, techInfoPythonCtx, techInfoVolatilityCtx, techInfoSeleniumCtx, techInfoJqueryCtx, techInfoBootstrapCtx, techInfoPowershellCtx, techInfoTensorFlowCtx, ]));

	$("#row-about").html(HTML([aboutIntroCtx, aboutPeopleCtx]));


	// $('.results-table').DataTable({
	// 	"pageLength": 5
	// 	// pageLength : 5
	// });

	
	$("#triage-whois-table").DataTable({
		'pageLength': 5,
		'lengthMenu': [5,10,15,20],
		'columns' : [
			{'data': 'IP'},
			{'data': 'Organisation'},
			{'data': 'HostName'},
			{'data': 'ISP'},
			{'data': 'Continent'},
			{'data': 'Country'},
			{'data': 'State/Region'},
			{'data': 'City'}
		]
	});

	$("#triage-exes-table").DataTable({
		'pageLength': 5,
		'lengthMenu': [5,10,15,20],
		'columns': [
			{'data':'File Name'},
			{'data':'MD5'},
			{'data':'SHA1'},
			{'data':"VirusTotal"},
			{'data':"Heuristics Indicators"},
			{'data':"Tensorflow Model"}
		]
	});

	$("#triage-dlls-table").DataTable({
		'pageLength': 5,
		'lengthMenu': [5,10,15,20],
		'columns': [
			{'data':'File Name'},
			{'data':'MD5'},
			{'data':'SHA1'},
			{'data':"VirusTotal"},
			{'data':"Heuristics Indicators"},
			{'data':"Tensorflow Model"}
		]
	});

	$('#triage-evt-table').DataTable({
		'pageLength':5,
		'columns': [
			{'data' : 'RuleTriggered'},
			{'data' : 'RuleName'},
			{'data' : 'EventID'},
			{'data' : 'Timestamp'},
			{'data' : 'EventRecordID'},
			{'data' : 'Description'},
			{'data' : 'IPAddress'}
		]
	});

	$('.nav-item').click(function() {

		// Set Sidebar to active then toggle page
		if (!$(this).hasClass('active')) {
			$('.nav-item').removeClass('active');
			$(this).addClass('active');
			
			// Hide all content row first       
			$("#content-header").text(arrTitles[$(this).attr('id').replace("side-", "")]);
			$(".content-row").hide();
			$("#"+$(this).attr('id').replace("side", "content-header")).show()
			$("#" + $(this).attr('id').replace("side", "row")).fadeIn(1000);
			// console.log($(this).attr('id'))
		}		
	});



	$('.home-card').click(function() {
		var cat = $(this).attr('id').split('-')[1];

		if (!$('side-' + cat).hasClass('active')) {
			$('.nav-item').removeClass('active');
			$('#side-' + cat).addClass('active');

			$("#content-header").text(arrTitles[cat]);
			$(".content-row").hide();
			$('#content-header-' + cat).show();
			$("#row-" + cat).fadeIn(1000);
		}
	});
	/* --- End of Toggle Pages --- */

	// --- 1 Volatility dump events --- //
	$('#volatility-ram-dump-input').click(function() {
		needsUpdate.volRamDumpInput = true;
		// console.log(needsUpdate.volRamDumpInput);
	});

	window.volRamDumpInputed = function () {
		$('#volatility-ram-dump-input-label').html(inputFilePaths.ramImage);
		inputFilePaths.ramImage = "";
	};


	window.volFinishedDump = function() {
		volFields.caseName = "";
		volFields.ramFilePath = "";
	}

	$("#volatility-btn-dump").click(function() {
		volFields.caseName = $('#volatility-card-input-case-name').val();
		volFields.ramFilePath = $('#volatility-ram-dump-input-label').html();
		if (volFields.caseName != "") {
			needsUpdate.volExecuteDump = true;
		} else {
			toastr.error("Please input valid case name");
		}	

	})

	// --- End of Volatility dump events --- //



	$('#triage-dump-folder').click(function(){
		needsUpdate.triageCaseFolderInput = true;
	});


	window.triageFolderInputed = function() {
		$('#triage-dump-folder-label').html(inputFilePaths.triageFolderPath);
		inputFilePaths.triageFolderPath = "";
	}

	


	

	window.triageFinishedAnalysis = function() {
		triageFields.caseFolderPath = ""; //Reset triageFields inputs

		console.log(modesResultsData.triage)

		// Update all tables using the modesResultsData['triage']
		

	}	

	updateTableData = function(tblId, tblHeaders, tblData) {
		console.log(tblData);
		if (tblData != "None") {
			var tbl = $('#'+tblId).DataTable();
			tbl.clear();
			tbl.rows.add(tblData);
			tbl.draw();
		}
		

	}

	updateResultLabels = function(labelId, text) {
		$('#'+labelId).html(text);
	}

	$('#triage-dump-run').click(function() {
		triageFields.caseFolderPath = $('#triage-dump-folder-label').html();

		console.log(triageFields.caseFolderPath);
		// triageFields = imageFilePath: 'c:\\users\\user\\desktop\\test.txt'}
		needsUpdate.triageExecuteAnalysis = true;


		// triage-result-meta-name
		// triage-result-meta-datetime-label
		// triage-result-meta-model-label
		// triage-domain-info-label
		// triage-malign-files-info-label
		// triage-malign-events-info-label
		// 
		// triage-whois-table
		// triage-exes-table
		// triage-dlls-table		
	});

	window.execTriageDumpRun = function () {


		updateResultLabels("triage-result-meta-name", "ImgName");
		updateResultLabels("triage-result-meta-datetime-label", "ImgDateTime");
		updateResultLabels("triage-result-meta-model-label", "ImgModel");
		updateResultLabels("triage-result-meta-manufacturer-label", "ImgManufacturer");
		updateResultLabels("triage-process-info-label", "ProcessesCount");
		updateResultLabels("triage-domain-info-label", "DomainsCount");
		updateResultLabels("triage-malign-files-info-label", "MalignFileCount");
		updateResultLabels("triage-malign-events-info-label", "FlaggedEvents");

		// $('#triage-exes-table').DataTable().clear().draw();

		updateTableData("triage-whois-table", 
			["IP", "Organisation", "HostName", "ISP", "Continent", "Country", "State/Region", "City"],
			modesResultsData['triage']['WhoIsDomainDetails']);

		updateTableData("triage-exes-table", 
			['File Name', 'MD5', 'SHA1', "VirusTotal", "Heuristics Indicators", "Tensorflow Model"],
			modesResultsData['triage']['FilesAnalysisDetails']);

		updateTableData("triage-dlls-table", 
			['File Name', 'MD5', 'SHA1', "VirusTotal", "Heuristics Indicators", "Tensorflow Model"],
			modesResultsData['triage']['DLLAnalysisDetails']);
		
		updateTableData("triage-evt-table", 
			['RuleTriggered', 'RuleName', 'EventID', 'Timestamp', 'EventRecordID', 'Description', 'IPAddress'],
			modesResultsData['triage']['EventLogAnalysisDetails']);



		$('#res-triage-panel').show(100);
	};


	


	var startUp = function() {
		$('#side-home').addClass("active");
		$('.content-row').hide();
		$('#row-home').show();

		$('.results-container').hide();
	}

	startUp();

// End of OnloadDoc
});




</script>

</head>
	<body id="page-top">
		<!-- Page Wrapper -->
		<div id="wrapper">
			<!-- Sidebar -->
			<ul id="accordionSidebar" class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion unselectable" >
				<!-- Sidebar - Brand -->
				<br><br>
				<a id="side-logo" class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
					<center></center><img src="img/enigma.png" alt="Enigma"  style="width:150px;height:150px;" >  </center>
				</a>
				<br> <br>
				<!-- Divider -->
				<hr id='first-boarder' class="sidebar-divider my-0">

				<hr class="sidebar-divider d-none d-md-block">
				<!-- Sidebar Toggler (Sidebar) -->
				<div class="text-center d-none d-md-inline">
					<button class="rounded-circle border-0" id="sidebarToggle"></button>
				</div>
			</ul>
			<!-- End of Sidebar -->



			<!-- Content Wrapper -->
			<div id="content-wrapper" class="d-flex flex-column">
				<!-- Main Content -->
				<div id="content">
					<!-- Topbar -->
					<div class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
						<!-- Sidebar Toggle (Topbar) -->
						
					</div>
					<!-- End of Topbar -->



					<!-- Begin Page Content -->
					<div id="page-content-area" class="container-fluid">
						<!-- Page Heading -->
						<input type="file" webkitdirectory multiple>
						
						<div class="content-header-container d-sm-flex align-items-center justify-content-center mb-4 unselectable">
							<h1 id="content-header" class="h1 text-gray-800">What do you want to do?</h1>
						</div>
<!-- "row-home"
"row-volatility"
"row-triage"
"row-malware"
"row-event"
"row-review"
"row-about"
"row-technologies"
 -->
						
						<div id='row-home' class='row content-row'>


						</div>

						<div id='row-volatility' class='row content-row'>

						</div>

						<div id='row-triage' class='row content-row'>

						</div>

						<div id='row-malware' class='row content-row'>
							
						</div>

						<div id='row-event' class='row content-row'>

						</div>

						<div id='row-review' class='row content-row'>

						</div>

						<div id='row-technologies' class='row content-row'>

							<!-- Section Heading -->
						

						</div>

						<div id='row-about' class='row content-row'>
							
						</div>


					</div>
				<!-- Footer -->
				<footer class="sticky-footer bg-white">
				<div class="container my-auto">
				  <div class="copyright text-center my-auto">
					<span></span>
				  </div>
				</div>
			  </footer>

			</div>
			<!-- End of Content Wrapper -->
		</div>
		<!-- End of Page Wrapper -->
		<!-- Scroll to Top Button-->
		<a class="scroll-to-top rounded" href="#page-top">
		<i class="fas fa-angle-up"></i>
		</a>


	
		
		<!-- Bootstrap core JavaScript-->
		
		<!-- Custom scripts for all pages-->
		<script src="js/sb-admin-2.min.js"></script>
		<!-- Page level plugins -->
		<script src="vendor/chart.js/Chart.min.js"></script>
		<!-- Page level custom scripts -->
		<script src="js/demo/chart-area-demo.js"></script>
		<script src="js/demo/chart-pie-demo.js"></script>
	</body>
</html>

