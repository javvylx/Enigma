<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>Genesis 1.0</title>

<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="css/google-fonts.css" rel="stylesheet">

<link href="css/sb-admin-2.min.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet">
<link href="vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">

<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- <link rel="stylesheet" type="text/css" href="ui_libs/bootstrap.css"> -->
<script src="ui_libs/popper.min.js"></script>
<script src="ui_libs/toastr.min.js"></script>
<script src="ui_libs/loadingoverlay.min.js"></script>
<script src="ui_libs/aris.js"></script>
<script src="vendor/datatables/jquery.dataTables.min.js"></script>
<script src="vendor/datatables/dataTables.bootstrap4.min.js"></script>

<script language="javascript">


window.needsUpdate = {csv: true, benchmarking: false, plot_map: false, ram_dump_input: false };

window.inputFilePaths = {ramFolder: ''};

$(function () {

	function genSideDividerCtx() {
		return ['hr', {class: 'sidebar-divider'}];
	}

	function genSideSubHeaderCtx(label) {
		return ['div', {class: 'sidebar-heading'}, label];
	}

	function genSideItemCtx(eleId, label, iconclass) {
		return ['li', {class: 'nav-item unselectable', id: eleId},
			['a', {class: 'nav-link'},
				['i', {class: 'fa-fw ' + iconclass}],
				['span', label]
			]
		];
	}

	function genParaCtx(text, styleClass) {
		return ['p', {class: styleClass}, text];
	}

	function genPageIntroCardCtx(title, titleImgClass, paragraphs, rowClass) {
		return ['div', {class: 'col-xl-12 col-md-12 mb-4'}, 
			['div', {class: ' carddiscored shadow mb-4'}, 
				['div', {class: 'card-header py-3'},
					['a', {class: 'm-0 font-weight-bold text-primary'},title],
					['i', {class: 'ml-2 fa-1x ' + titleImgClass + " "}]
	            ],
	            ['div', {class: 'card-body ' + rowClass},
	                	paragraphs
	            ]
	        ]
	    ];

	}

	function genImageDescCardCtx(title, paragraphs) {
		return ['div', {class: 'col-xl-12 col-md-12 mb-4'}, 
			['div', {class: 'border-bottom-secondary carddiscored shadow mb-4'}, 
				['div', {class: 'card-header py-3'},
					['h6', {class: 'm-0 font-weight-bold text-primary'},title]                
	            ], paragraphs
	        ]
	    ];

	}


	function genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, bodyElements) {
		return ['div', {class: 'unselectable mb-4 ' + gridClass},
			['div', {id: cardId, class: 'card shadow h-100 py-2' + " border-bottom-" + colorStyle + " " + hoverStyle}, 
				['div', {class: 'card-body'},
					bodyElements
				]
			]
		];
	}

	function genInfoBodyCtx(title, desc, iconClass, colorStyle) {
		return ['div', {class: 'row no-gutterse align-items-center'},
			['div', {class: 'col mr-2'},
				['div', {class: "text-xl font-weight-bold text-uppercase mb-5 text-" + colorStyle}, title],
				['div', {class: "h5 mb-0 font-weight-bold text-gray-800"}, desc]
			],
			['div', {class: 'col-auto'},
				['i', {class: 'text-gray-700  ' + iconClass}]
			]
		];
	}

	function genSmallBodyCtx(title, desc, iconClass, colorStyle) {
		return ['div', {class: 'row no-gutterse align-items-center justify-content-center mb-0 d-flex'},
			['div', {class: 'col mr-2'},
				['div', {class: "text-xl font-weight-bold text-uppercase mb-5 text-" + colorStyle}, title],
				['div', {class: "h5 mb-0 font-weight-bold text-gray-800"}, desc]
			],
			['div', {class: 'col-auto'},
				['i', {class: 'text-gray-700 ' + iconClass}]
			]
		];
	}
	

	function genHomeCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, desc, iconClass) {
		return genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, genInfoBodyCtx(title, desc, iconClass, colorStyle));
	}

	function genTriageCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, desc, iconClass) {
		return genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, genSmallBodyCtx(title, desc, iconClass, colorStyle));
	}

	function genMalwareCardCtx(cardId, gridClass, colorStyle, hoverStyle, title, desc, iconClass) {
		return genInfoCardCtx(cardId, gridClass, colorStyle, hoverStyle, genSmallBodyCtx(title, desc, iconClass, colorStyle));
	}
	// Context for inputs
	function genButtonCtx(btnId, label, iconClass, colorStyle) {
		return ['a', {id: btnId, class: 'btn btn-icon-split mt-4 ' + "btn-" + colorStyle},
			['span', {class: 'icon text-white-50'},
				['i', {class : iconClass}]
			],
			['span', {class: 'text btn-white'}, label]
		];
	}

	function genInputSelectorCtx(inputId, placeHolder, type) {
		var input = null;
		if (type === "FILE") {
			input = ['input',  {id: inputId, class: 'custom-file-input', required: "required"},
				['label', {id : inputId + "-label", class: 'custom-file-label', for: 'validatedCustomFile'}, placeHolder],
	    		['div', {class: 'invalid-feedback'}, "Invalid file"]
	    	];
		} else if (type === "FOLDER") {
			input = ['input',  {id: inputId, class: 'custom-file-input'},
				['label', {id : inputId + "-label", class: 'custom-file-label', for: 'validatedCustomFile'}, placeHolder],
	    		['div', {class: 'invalid-feedback'}, "Invalid folder"]
			];
		}
		return ['div', {class: 'custom-file'}, input];

	}

	
	function genFileSelectCtx(cardId, cardTitle, inputId, inputPlaceHolder, inputType, btnId, btnLabel, btnIconClass, colorStyle) {
		return ['div', {class: 'col-xl-12 col-md-12 mb-4'},
			['div', {class: 'card  shadow h-100 py-3 border-left-' + colorStyle + ' '},
				['div', {class: 'card-body'},
					['div', {class: 'row no-gutters align-items-center'},
						['div', {class: 'col mr-2'},
	                    	['div',{class: 'text-xs font-weight-bold text-info text-uppercase mb-1'}, cardTitle],
	                    	genInputSelectorCtx(inputId, inputPlaceHolder, inputType), 
	                    	genButtonCtx(btnId, btnLabel, btnIconClass, colorStyle)
	                  	]                  	
	                    
	                ]
	            ]        
	        ]
	    ];
	}



	function genTriageCheckBoxCtx(chkId, title, iconClass) {
		return ['div', {class: 'no-gutterse align-items-center justify-content-center'}, 
			['div', {class: 'justify-content-center'}, 
				['div', {class: 'row card-header'},
					['div', {class: ''},
						['p', {class: 'm-0 font-weight-bold text-primary'},title],
						['a', {class: 'fa-2x fas fa-wifi'}]	            		
					],
					['div', {class: 'ml-auto my-auto mr-5'},

						['input', {class: 'ml-auto big-checkbox form-check-input', id: "defaultCheck1", type: 'checkbox', value: ''}],

					]					
	            ]
	            
	        ]
	    ];	
	}


	function genTriageFunctionCheckCtx() {
		// function genInfoBodyCtx(title, iconClass, colorStyle)
		return genInfoCardCtx("col-xl-3 col-md-4", "primary", genTriageCheckBoxCtx("chk1", "Network", "fas fa-wifi"));
	}



	// Display Side Bar
	var sideHomeCtx = genSideItemCtx("side-home", "Home", "fas fa-tachometer-alt active");
	var sideMemoryCtx = genSideItemCtx("side-memory", "Memory Dump", "fas fa-memory");
	var sideTriageCtx = genSideItemCtx("side-triage", "Triage Analysis", "fab fa-searchengin");
	var sideMalwareCtx = genSideItemCtx("side-malware", "Malware Heuristics", "fas fa-biohazard");
	var sideEventCtx = genSideItemCtx("side-event", "Event Logs Correlator", "fas fa-chart-area");
	var sideTechnologiesCtx = genSideItemCtx("side-technologies", "Technologies Used", "fas fa-question-circle");
	var sideAboutCtx = genSideItemCtx("side-about", "About", "fas fa-user-secret");

	var sideMenuCtx = [
		sideHomeCtx,
		genSideDividerCtx(),
		genSideSubHeaderCtx("Triage"),
		sideMemoryCtx,
		sideTriageCtx,
		genSideDividerCtx(),
		genSideSubHeaderCtx("Analysis"),
		sideMalwareCtx,
		sideEventCtx,
		genSideDividerCtx(),
		genSideSubHeaderCtx("Misc"),
		sideTechnologiesCtx,
		sideAboutCtx
	];

// End of Display Side menu

"row-home"
"row-memory"
"row-triage"
"row-malware"
"row-event"
"row-about"
"row-technologies"



// Network		netscan
// Commands	cmdscan
// Process		ProcessDump
// Files Processes	dlldump (doing now)
// Process Tree
// Domains		

// gridClass, colorStyle, title, desc, iconClass

	var homeMemoryDumpCtx = genHomeCardCtx("home-memory-card", "col-xl-6 col-md-6 col-sm-12 col-12", "primary", "home-card", "Memory Dump", "Extract of host PC's RAM for Triage Analysis", "fa-6x fas fa-memory");

	var homeTriageCtx = genHomeCardCtx("home-triage-card", "col-xl-6 col-md-6 col-sm-12 col-12", "success", "home-card", "Triage Analyis", "Conducts full analysis of memory dump with analysis modules", "fa-6x fab fa-searchengin");

	var homeMalwareCtx = genHomeCardCtx("home-malware-card", "col-xl-6 col-md-6 col-sm-12 col-12", "danger", "home-card", "Malware Heuristics", "Classify & identify IOCs of PE file using heuristics", "fa-6x fas fa-biohazard");

	var homeEventLogCtx = genHomeCardCtx("home-event-card", "col-xl-6 col-md-6 col-sm-12 col-12", "danger", "home-card", "Event Logs Correlator", "Identify potential footprints of malwares with event logs", "fa-6x fas fa-chart-area");


	var dashboardCtxs = [homeMemoryDumpCtx,homeTriageCtx,homeMalwareCtx,homeEventLogCtx];


	var memRamSizeCardCtx = ['div', {class: 'col-xl-12 col-md-12 mb-4'},
		['div', {class: 'card border-left-success shadow h-100 py-3'},
			['div', {class: 'card-body'},
				['div', {class: 'row no-gutters align-items-center'},
					['div', {class: 'col mr-2'},
                    	['div',{class: 'text-xl font-weight-bold text-success text-uppercase mb-1'}, "Available RAM Size"],
                    	['div', {class: 'h2 mb-0 font-weight-bold text-gray-800'}, "32 GB"]
                  	],
                  	['div', {class: 'col-auto'}, 
                  		['i' , {class: 'fas fa-memory fa-6x text-gray-300'}]
                  	]
                    
                ]
            ]        
        ]
    ];


 	var memRequiredInputCtx = genFileSelectCtx("mem-card-select-folder",
		"Choose your folder to dump RAM",
		"mem-input-folder",
		"Choose folder...",
		"FOLDER",
		"mem-btn-dump",
		"Execute Dump",
		"fas fa-play",
		"info"
 	);

 	var triageInstructionsCtx = genPageIntroCardCtx("Instructions", "fas fa-info-circle", [
 		genParaCtx("Fill in case name & choose folder location to dump analysis output", "", "")
	]);

 	var triageFunctionsDescCtx = genPageIntroCardCtx("Functionalities", "fas fa-atom", [
 		genParaCtx("The whole triage process covers the following ", "h4 col-12 mb-5" ),
 		genTriageCardCtx("triage-func-network", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "success", "", "Network Connectivity", "", "fa-2x fas fa-wifi icon-cog"),
 		genTriageCardCtx("triage-func-command", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "success", "", "Commands Executed", "", "fa-2x fas fa-terminal"),
 		genTriageCardCtx("triage-func-process", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "success", "", "Processes", "", "fa-2x fas fa-microchip"),
 		genTriageCardCtx("triage-func-files", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "success", "", "Files", "", "fa-2x fas fa-file-alt"),
 		genTriageCardCtx("triage-func-domains", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "success", "", "Domains", "", "fa-2x fas fa-server"),
 		genTriageCardCtx("triage-func-virustotal", "col-xl-4 col-lg-6 col-md-6 triage-desc-card", "success", "", "Virustotal", "", "fa-2x fas fa-viruses")],
 		"row"
 	);



	var triageRequiredInputCtx = genFileSelectCtx("triage-card-select_image",
		"Choose your RAM image file",
		"triage-input-image",
		"Choose file...",
		"FILE",
		"triage-btn-run",
		"Execute analysis",
		"fas fa-play",
		"info"
 	);

 	var malwareFunctionsCtx = genPageIntroCardCtx("Functions", "fas fa-atom", [
 		genParaCtx("This module analyses Portable Executables (PE) files in several aspect", "fa-2x h4 col-12 mb-5" ),
 		genMalwareCardCtx("malware-func-heuristics", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "primary", "", "Heuristics", "", "fa-2x fas fa-viruses"),
 		genMalwareCardCtx("malware-func-entropy", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "primary", "", "Entropy", "", "fa-2x fas fa-sort-numeric-up-alt"),
 		genMalwareCardCtx("malware-func-imports", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "primary", "", "Functions", "", "fa-2x fas fa-file-import"),
 		genMalwareCardCtx("malware-func-ml", "col-xl-3 col-lg-6 col-md-6 triage-desc-card", "primary", "", "ML", "", "fa-2x fas fa-robot")],
 		"row"
	);

 	var malwareRequiredInputCtx = genFileSelectCtx("malware-card-select-file",
 		"Choose your PE file to analyse",
		"malware-input-folder",
		"Choose file...",
		"FILE",
		"malware-btn-run",
		"Execute analysis",
		"fas fa-play",
		"info"
 	);


 	var evtInstructionsCtx = genPageIntroCardCtx("Information", "fas fa-info-circle", [
 		genParaCtx("Select desired windows log to analyse. Some examples of windows logs are Security.evtx, System.evtx, etc.", "", "")
	]);

 	var evtRequiredInputCtx = genFileSelectCtx("evt-card-select-file",
 		"Choose your Windows Log to analyse",
		"evt-input-folder",
		"Choose file...",
		"FILE",
		"evt-btn-run",
		"Execute correlation",
		"fas fa-play",
		"info"
 	);

 	function genTableWithDivCtx(mainDivId, subDivId, tblId, divDesc) {
 		return ['div', {id: mainDivId, class: 'col-xl-12 col-md-12 mb-4'},
	 		['div', {class: 'card shadow mb-4'},
	            ['div', {class: 'card-header py-3'},
	             	['h6',  {class: 'm-0 font-weight-bold text-primary'}, divDesc]
	            ],
	            ['div', {id: subDivId, class: 'card-body'},
	            	['div', {class: 'table-responsive'},
		            	['table', {id: tblId, class: 'table table-bordered', id: 'dataTable',  width: '100%', cellspacing: '0'},
							['thead', 
								['tr',
									['th', ,'TimeStamp'],
									['th', 'EventID'],
									['th', 'Classification Type'],
									['th', 'Desc']
								]
							],
			                ['tbody',
			                    ['tr',
			                    	['td', 'Passaway time'],
			                    	['td', 'Your daddy ID'],
			                    	['td', 'Dropout'],
			                    	['td', 'Im gona suicide']
				                ],
				                ['tr',
									['td', 'Passaway time'],
									['td', 'Your daddy ID'],
									['td', 'Dropout'],
									['td', 'Im gona suicide']
			                    ]
			                ]
		               ]
	              	]
	            ]
	        ]
        ];	
        
 	}

 	// var evtResultsTableCtx = 
 	// Population of elements into specific rows

	$('#row-home').html(HTML(dashboardCtxs));
	$(HTML(sideMenuCtx)).insertAfter('#first-boarder');
	// 1
	$('#row-memory').html(HTML([memRamSizeCardCtx, memRequiredInputCtx]));

	// 2
	$('#row-triage').html(HTML([triageInstructionsCtx, triageFunctionsDescCtx, triageRequiredInputCtx]));

	// 3
	$('#row-malware').html(HTML([malwareFunctionsCtx, malwareRequiredInputCtx]));

	$('#row-event').html(HTML([evtInstructionsCtx, evtRequiredInputCtx, genTableWithDivCtx('evt-results-cont', 'evt-results-sub-cont', 'evt-results-tbl', 'Log Analysis Results')]));


	$('#dataTable').DataTable();

	var arrTitles = {
			"home": "What do you want to do",
			"memory": "RAM Dump",
			"triage": "Volatility Dump",
			"malware": "Malware Heuristics",
			"event": "Windows Logs Correlator",
			"about": "About",
			"technologies": "Technologies"
	};

	$('.nav-item').click(function() {

		// Set Sidebar to active then toggle page
		if (!$(this).hasClass('active')) {
			$('.nav-item').removeClass('active');
			$(this).addClass('active');
			
			// Hide all content row first		
			$("#content-header").text(arrTitles[$(this).attr('id').replace("side-", "")]);
			$(".content-row").hide();
			$("#"+$(this).attr('id').replace("side", "content-header")).show()
			$("#" + $(this).attr('id').replace("side", "row")).fadeIn(1000);
			console.log($(this).attr('id'))
		}
		
	});

	$('.home-card').click(function() {
		var cat = $(this).attr('id').split('-')[1];

		if (!$('side-' + cat).hasClass('active')) {
			$('.nav-item').removeClass('active');
			$('#side-' + cat).addClass('active');

			$("#content-header").text(arrTitles[cat]);
			$(".content-row").hide();
			$('#content-header-' + cat).show();
			$("#row-" + cat).fadeIn(1000);
		}
	});
	/* --- End of Toggle Pages --- */

	window.ram_dump_inputed = function () {
		console.log(inputFilePaths.ramFolder);
		$('#mem-input-folder-label').html(inputFilePaths.ramFolder);
		inputFilePaths.ramFolder = "";
	};

	
	$('#mem-input-folder').click(function(){
		needsUpdate.ram_dump_input = true;
	});


	$('#memory-folder-input').on('change', function(e) {
		console.log(getMethods(e));
		$('#memory-folder-input-label').text(e.target.files[0].webkitRelativePath);

	});


	var startUp = function() {
		$('#side-home').addClass("active");
		$('.content-row').hide();
		$('#row-home').show();
	}

	startUp();

// End of OnloadDoc
});




</script>

</head>
	<body id="page-top">
		<!-- Page Wrapper -->
		<div id="wrapper">
			<!-- Sidebar -->
			<ul id="accordionSidebar" class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion unselectable" >
				<!-- Sidebar - Brand -->
				<a id="side-logo" class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
					<div class="sidebar-brand-text mx-3">Genesis 1.0</div>
				</a>
				<!-- Divider -->
				<hr id='first-boarder' class="sidebar-divider my-0">

				<hr class="sidebar-divider d-none d-md-block">
				<!-- Sidebar Toggler (Sidebar) -->
				<div class="text-center d-none d-md-inline">
					<button class="rounded-circle border-0" id="sidebarToggle"></button>
				</div>
			</ul>
			<!-- End of Sidebar -->



			<!-- Content Wrapper -->
			<div id="content-wrapper" class="d-flex flex-column">
				<!-- Main Content -->
				<div id="content">
					<!-- Topbar -->
					<div class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
						<!-- Sidebar Toggle (Topbar) -->
						
					</div>
					<!-- End of Topbar -->



					<!-- Begin Page Content -->
					<div id="page-content-area" class="container-fluid">
						<!-- Page Heading -->
						<div class="content-header-container d-sm-flex align-items-center justify-content-center mb-4 unselectable">
							<h1 id="content-header" class="h1 text-gray-800">What do you want to do?</h1>
						</div>
<!-- "row-home"
"row-memory"
"row-triage"
"row-malware"
"row-event"
"row-about"
"row-technologies"
 -->
						
						<div id='row-home' class='row content-row'>


						</div>

						<div id='row-memory' class='row content-row'>

						</div>

						<div id='row-triage' class='row content-row'>

						</div>

						<div id='row-malware' class='row content-row'>
							
						</div>

						<div id='row-event' class='row content-row'>

						</div>

						<div id='row-about' class='row content-row'>
							
						</div>

						<div id='row-technologies' class='row content-row'>
							<!--  -->
						</div>
									


					</div>


			</div>
			<!-- End of Content Wrapper -->
		</div>
		<!-- End of Page Wrapper -->
		<!-- Scroll to Top Button-->
		<a class="scroll-to-top rounded" href="#page-top">
		<i class="fas fa-angle-up"></i>
		</a>
	
		
		<!-- Bootstrap core JavaScript-->
		
		<!-- Custom scripts for all pages-->
		<script src="js/sb-admin-2.min.js"></script>
		<!-- Page level plugins -->
		<script src="vendor/chart.js/Chart.min.js"></script>
		<!-- Page level custom scripts -->
		<script src="js/demo/chart-area-demo.js"></script>
		<script src="js/demo/chart-pie-demo.js"></script>
	</body>
</html>

